<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>用户中心Meilele 美乐乐家具网,网上家具商城:在线销售沙发 软床 实木床 餐桌 衣柜 韩式家具 美式家具 现代家具等</title>
		<link rel="stylesheet" type="text/css" href="css/public.css"/>
		<link rel="stylesheet" type="text/css" href="css/iconfont.css"/>
		<link rel="stylesheet" type="text/css" href="css/shop.css"/>
	</head>
	<body>
		<div class="click">
			<a class="discount" href="#" target="_blank"><img src="img/discount.jpg" ></a>
		</div>
		<div class="header margin clear">
			<div class="headers">
				<a href="#" class="logo"><img src="img/logo2.png" ></a>	
				<div class="help">
					<a href="index.html" target="_blank">返回首页</a> | 
					<a href="#" target="_blank">帮助中心</a>
				</div>
			</div>
		</div>
		<div id="main">
			<table border="1" cellspacing="0" width="1000" align="center">
				<thead>
					<tr>
						<th></th>
						<th width="100">商品图片</th>
						<th>名字</th>
						<th>价格</th>
						<th width="120">数量</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody id="tbody">
					<!--<tr>
						<td><input type="checkbox" name="" id="" value="" /></td>
						<td><img src=""/></td>
						<td>名字</td>
						<td>价格</td>
						<td>1</td>
						<td><em data-index="">删除</em></td>
					</tr>-->
				</tbody>
				<tfoot>
					<tr>
						<td colspan="2"><input type="checkbox" name="" id="" value="" />全部选中</td>
						<td align="right">总价：</td>
						<td>3344</td>
						<td>总数量：10</td>
						<td><em>全部删除</em></td>
					</tr>
				</tfoot>
			</table>
		</div>
		<div id="footer">
			<div class="margin">
				<ul class="foot-view">
					<li>
						<div class="switch">
							<span>热门城市：</span>
							<a href="#" target="_blank">北京家具</a>
							<a href="#" target="_blank">上海家具</a>
							<a href="#" target="_blank">重庆家具</a>
							<a href="#" target="_blank">武汉家具</a>
							<a href="#" target="_blank">深圳家具</a>
							<a href="#" target="_blank">南京家具</a>
							<a href="#" target="_blank">郑州家具</a>
							<a href="#" target="_blank">成都家具</a>
							<a href="#" target="_blank">济南家具</a>
							<a href="#" target="_blank">福州家具</a>
							<a href="#" target="_blank">天津家具</a>
						</div>
					</li>
					<li>
						<div class="switch">
							<span>友情链接：</span>
							<a href="#" target="_blank">汽车用品</a>
							<a href="#" target="_blank">上海爱早教</a>
							<a href="#" target="_blank">上海淘家具</a>
							<a href="#" target="_blank">上海结婚网</a>
							<a href="#" target="_blank">上海人才招聘</a>
							<a href="#" target="_blank">上海别墅装修</a>
							<a href="#" target="_blank">郑州家具</a>
							<a href="#" target="_blank">上海汽车网</a>
							<a href="#" target="_blank">上海人才招聘</a>
							<a href="#" target="_blank">福州家具</a>
							<a href="#" target="_blank">上海爱早教</a>
						</div>
					</li>
				</ul>
				<div class="foot-copy">
					<ul class="copyl">
						<li>
							<a href="#" target="_blank">装修网</a> | <a href="#" target="_blank">家具图片</a> | <a href="#" target="_blank">装修网</a> | <a href="#" target="_blank">家具图片</a> | <a href="#" target="_blank">装修网</a> | <a href="#" target="_blank">家具图片</a> | <a href="#" target="_blank">装修网</a> | <a href="#" target="_blank">家具图片</a> | <a href="#" target="_blank">装修网</a> | <a href="#" target="_blank">网站地图</a> | <a href="#" target="_blank">友情链接</a> | <a href="#" target="_blank">更多</a>
						</li>
						<li>
							<span>© 2005-2018 </span>
							<span>美乐乐</span>
							<span> 天津美维信息技术有限公司 版权所有，并保留所有权利。</span>
							<a href="#" target="_blank">ICP备案证书号：粤ICP备08008334号</a>
						</li>
					</ul>
					<ul class="copyr">
						<li>
							<a href="#" target="_blank"><img src="img/timg.jpg" /><span class="tee">诚信网站</span></a>							
						</li>
						<li>
							<a href="#" target="_blank"><img src="img/timg.jpg" /><span>认证联盟品牌官网</span></a>							
						</li>
						<li>
							<a href="#" target="_blank"><img src="img/timg.jpg" /><span>可信网站信用评价</span></a>							
						</li>
						<li>
							<a href="#" target="_blank"><img src="img/timg.jpg" /><span>经营网站备案信息</span></a>							
						</li>
					</ul>
				</div>
			</div>
		</div>
	</body>
	<script src="libs/jquery.2.2.4.js" type="text/javascript" charset="utf-8"></script>
	<script src="libs/ajax.3.0.js" type="text/javascript" charset="utf-8"></script>
	<script src="libs/cookie.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		class Login{
			constructor(){
				this.url = "http://www.icodeilife.cn/ctrl/login.php";
				this.init();
			}
			init(){
				var that = this;
				$(".btn").click(function () {
					that.load();
				})
			}
			load(){
				var that = this;
				$.ajax({
					url:this.url,
					data:{
						user:$("#user").val(),
						pass:$("#pass").val(),
					},
					success:function (res) {
						$(".return").css({display:"block"})
						switch(res){
							case "0":
								$(".return").html("用户名错误");break;
							case "1":
								$(".return").html("重新登陆");break;
							default:
								$(".return").html("成功");
								that.res = JSON.parse(res)
								setTimeout(()=>{
									location.href = "index.html"
								},2000);break;
						}
					},
					beforeSend:function(){
						$("return").html("<img src='loading.gif'>")
					}
				})
			}
		}
	
		new Login;
	</script>
	<script type="text/javascript">
		class Car{
			constructor(options){
				this.tbody = options.tbody;
				this.url = options.url;
				
				this.load();
				this.addEvent();
			}
			load(){
				var that = this;
				ajax({
					url:this.url,
					success:function(res){
						that.res = JSON.parse(res);
						that.getCookie();
					}
				})
			}
			getCookie(){
				this.goods = JSON.parse(getCookie("goods"));
				this.display();
			}
			display(){
				var str = "";
				for(var i=0;i<this.res.length;i++){
					for(var j=0;j<this.goods.length;j++){
						if(this.goods[j].id == this.res[i].shopsid){
							str +=`<tr>
										<td><input type="checkbox" name="" id="" value="" /></td>
										<td><img src="${this.res[i].src1}"/></td>
										<td>${this.res[i].name}</td>
										<td>${this.res[i].jiage}</td>
										<td><input type="number" value="${this.goods[j].num}" /></td>
										<td><em data-index="${this.res[i].shopsid}">删除</em></td>
									</tr>`
						}
					}
				}
				this.tbody.innerHTML = str;
			}
			addEvent(){
				var that = this;
				this.tbody.addEventListener("click",function(eve){
					var e = eve || window.event;
					var target = e.target || e.srcElement;
					if(target.nodeName == "EM"){
						that.id = target.getAttribute("data-index");
						target.parentNode.parentNode.remove();
						that.changeCookie(function(index){
							that.goods.splice(index,1);
						});
					}
				})
				this.tbody.addEventListener("input",function(eve){
					var e = eve || window.event;
					var target = e.target || e.srcElement;
					if(target.type == "number"){
						that.value = target.value;
						that.id = target.parentNode.nextElementSibling.children[0].getAttribute("data-index");
						that.changeCookie(function(index){
							that.goods[index].num = that.value;
						})
					}
				})
				
			}
			changeCookie(callback){
				for(var i=0;i<this.goods.length;i++){
					if(this.goods[i].id == this.id){
						break;
					}
				}
				callback(i);
				setCookie("goods",JSON.stringify(this.goods));
				
			}
			
						
		}
		
		new Car({
			tbody:document.getElementById("tbody"),
			url:"http://localhost/1901/meilele/data/goods1.json"
		})
	</script>
</html>
